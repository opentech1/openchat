# ==============================================================================
# OpenChat Environment Configuration
# ==============================================================================
# Copy this file to .env.local and fill in your values
#
# LEGEND:
# ‚úÖ REQUIRED - Must be set for the app to work
# üîß REQUIRED (with default) - Has a default but should be customized for production
# ‚öôÔ∏è  OPTIONAL - Can be omitted, has sensible defaults
# üß™ DEVELOPMENT ONLY - Only for local development
#
# ==============================================================================

# ==============================================================================
# ‚úÖ REQUIRED: Convex (Backend Database & Realtime Sync)
# ==============================================================================
# For Cloud-Hosted Convex:
# Get these from: bunx convex dev (local) or your Convex dashboard (production)
# Convex stores ALL data: users, chats, messages, AND auth sessions
# CONVEX_URL=https://your-project.convex.cloud
# NEXT_PUBLIC_CONVEX_URL=https://your-project.convex.cloud

# For Self-Hosted Convex (Docker):
# IMPORTANT: Understand the difference between these two URLs:
#
# CONVEX_URL: Server-to-server (Docker internal network)
#   - Local dev: http://localhost:3210
#   - Production: http://backend:3210 (Docker service name, NOT https://)
#
# NEXT_PUBLIC_CONVEX_URL: Browser-to-server (public internet)
#   - Local dev: http://localhost:3210
#   - Production: https://api.yourdomain.com (public URL with reverse proxy)

# Local Development
CONVEX_URL=http://localhost:3210
NEXT_PUBLIC_CONVEX_URL=http://localhost:3210

# Production Example (uncomment and modify):
# CONVEX_URL=http://backend:3210
# NEXT_PUBLIC_CONVEX_URL=https://api.osschat.dev

# Self-hosted admin key (generate with: docker compose exec backend ./generate_admin_key.sh)
# CONVEX_SELF_HOSTED_URL=http://backend:3210
# CONVEX_SELF_HOSTED_ADMIN_KEY=your_admin_key_here

# ==============================================================================
# üîß REQUIRED (with defaults): Public URLs
# ==============================================================================
# Web app URL (frontend) - used for OAuth callbacks, metadata, and CORS
# This is the PRIMARY URL variable; other URL variables are deprecated
# ‚ö†Ô∏è  PRODUCTION: Must be explicitly set to your production domain
# Development default: http://localhost:3001
NEXT_PUBLIC_APP_URL=http://localhost:3001

# API server URL (backend) - used for auth API routes
# ‚ö†Ô∏è  PRODUCTION: Must be explicitly set to your API domain
# Development default: http://localhost:3000
NEXT_PUBLIC_SERVER_URL=http://localhost:3000

# Convex URL (see section above for cloud vs self-hosted setup)
# ‚ö†Ô∏è  PRODUCTION: Must be explicitly set (see Convex section above)
# Development default: http://localhost:3210
# NEXT_PUBLIC_CONVEX_URL is already set above in the Convex section

# ==============================================================================
# DEPRECATED: Legacy URL Variables (use NEXT_PUBLIC_APP_URL instead)
# ==============================================================================
# The following variables are deprecated and will be removed in a future version.
# They are currently aliased to NEXT_PUBLIC_APP_URL for backwards compatibility:
# - SITE_URL (server-side fallback, still supported)
# - NEXT_PUBLIC_SITE_URL (deprecated)
# - NEXT_PUBLIC_WEB_URL (deprecated)
# - NEXT_PUBLIC_BASE_URL (deprecated)
# - NEXT_PUBLIC_ORIGIN (deprecated)

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: WorkOS AuthKit
# ==============================================================================
# Authentication is handled by WorkOS AuthKit
# Configure OAuth providers in the WorkOS dashboard: https://dashboard.workos.com
# WORKOS_CLIENT_ID=client_xxx
# WORKOS_API_KEY=sk_xxx
# WORKOS_REDIRECT_URI=http://localhost:3000/api/auth/callback
# WORKOS_COOKIE_PASSWORD=generate_with_openssl_rand_base64_32

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: Convex Deployment (Production)
# ==============================================================================
# For production deployments to Convex
# CONVEX_DEPLOYMENT=prod:your-deployment-name
# CONVEX_ADMIN_URL=https://your-project.convex.cloud
# CONVEX_SITE_URL is generated automatically by Convex for self-hosted setups

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: Analytics (PostHog)
# ==============================================================================
# For apps/web (Vite/TanStack):
# VITE_POSTHOG_KEY=your_posthog_key
# VITE_POSTHOG_HOST=https://us.i.posthog.com

# For apps/web-old (Next.js) - deprecated:
# NEXT_PUBLIC_POSTHOG_KEY=your_posthog_key
# NEXT_PUBLIC_POSTHOG_HOST=https://us.i.posthog.com
# POSTHOG_API_KEY=your_server_key
# POSTHOG_HOST=https://us.i.posthog.com

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: AI Providers
# ==============================================================================
# OSSChat Cloud uses OpenRouter as the backend for all AI requests
# This enables free AI access with daily limits (10¬¢/day) for all users
# Get API key from: https://openrouter.ai/settings/keys
# OPENROUTER_API_KEY=sk-or-v1-your-key-here

# Valyu API key for web search (20 searches/day free)
# Get API key from: https://valyu.ai
# VALYU_API_KEY=your_valyu_key

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: Advanced Configuration
# ==============================================================================
# Server-to-server internal URL (optional)
# SERVER_INTERNAL_URL=http://localhost:3000

# Cross-subdomain cookie domain (optional, for sharing auth between subdomains)
# AUTH_COOKIE_DOMAIN=.yourdomain.com

# ==============================================================================
# ‚öôÔ∏è  OPTIONAL: Rate Limiting Configuration
# ==============================================================================
# Rate limiting mode: "redis" | "memory" (auto-detects if not set)
# RATE_LIMIT_MODE=memory

# Upstash Redis (for distributed rate limiting in production)
# Get credentials from: https://console.upstash.com/redis
# When set, automatically enables Redis-based rate limiting across all instances
# UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your_token_here

# Rate limit behavior on Redis errors (true = allow requests, false = deny requests)
# RATE_LIMIT_FAIL_OPEN=true

# Chat creation rate limits
# CHAT_CREATE_RATE_LIMIT=10
# CHAT_CREATE_WINDOW_MS=60000

# OpenRouter API rate limits (for streaming chat)
# OPENROUTER_RATE_LIMIT_PER_MIN=30
# OPENROUTER_RATE_LIMIT_TRACKED_BUCKETS=1000

# ==============================================================================
# üß™ DEVELOPMENT ONLY: Auth Bypass
# ==============================================================================
# ‚ö†Ô∏è  WARNING: NEVER set NEXT_PUBLIC_DEV_BYPASS_AUTH=1 in production!
# These allow bypassing authentication for local development/testing
NEXT_PUBLIC_DEV_BYPASS_AUTH=0
NEXT_PUBLIC_DEV_USER_ID=dev-user
