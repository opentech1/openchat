# Server environment template (`apps/server/.env`)
# Copy to apps/server/.env (or .env.local) and replace placeholders.

# --- Postgres ---------------------------------------------------------------
POSTGRES_USER=openchat
POSTGRES_PASSWORD=replace-with-strong-password
POSTGRES_DB=openchat
DATABASE_URL=postgresql://openchat:replace-with-strong-password@openchat-postgres:5432/openchat
# Optional â€“ required only for running drizzle migrations locally.
SHADOW_DATABASE_URL=postgresql://openchat:replace-with-strong-password@openchat-postgres:5432/openchat_shadow

# --- ElectricSQL Cloud ------------------------------------------------------
# Service URL is shared by all teams in Electric Cloud.
ELECTRIC_SERVICE_URL=https://api.electric-sql.cloud
# Copy the Source Secret from the Electric Cloud dashboard.
ELECTRIC_SECRET=replace-with-electric-source-secret
# Gatekeeper uses the same signing secret; reuse ELECTRIC_SECRET or supply a new one.
ELECTRIC_GATEKEEPER_SECRET=replace-with-electric-source-secret

# Optional tuning
# ELECTRIC_FALLBACK_PORT=3000
# ELECTRIC_FALLBACK_DELAY_MS=150
# ELECTRIC__HTTP__HOST=api.electric-sql.cloud
# ELECTRIC__HTTP__PORT=443
# ELECTRIC__PG_PROXY__HOST=your-proxy-host
# ELECTRIC__PG_PROXY__PORT=5433

# --- API / Auth -------------------------------------------------------------
BETTER_AUTH_SECRET=replace-with-generated-secret
BETTER_AUTH_URL=https://api.ochat.pro
SERVER_INTERNAL_URL=http://openchat-server:3000
CORS_ORIGIN=https://ochat.pro
AUTH_COOKIE_DOMAIN=.ochat.pro
OPENROUTER_API_KEY_SECRET=your-openrouter-key-or-empty
TRUST_PROXY_FORWARDED=1
RATE_LIMIT_PER_MIN=60

# --- Runtime URLs shared with the web app -----------------------------------
NEXT_PUBLIC_SERVER_URL=https://api.ochat.pro
NEXT_PUBLIC_ELECTRIC_URL=https://electric.ochat.pro

# --- Analytics --------------------------------------------------------------
POSTHOG_API_KEY=replace-with-posthog-server-key
POSTHOG_HOST=https://us.i.posthog.com

# --- Backups (Cloudflare R2) ------------------------------------------------
R2_ACCOUNT_ID=replace-with-r2-account-id
R2_ACCESS_KEY_ID=replace-with-access-key
R2_SECRET_ACCESS_KEY=replace-with-secret-key
R2_BUCKET=openchat-backups
R2_PREFIX=prod/db
AWS_S3_FORCE_PATH_STYLE=true

# --- Runtime toggles --------------------------------------------------------
RUN_DB_MIGRATIONS=1
POSTGRES_WAIT_TIMEOUT=120000
POSTGRES_WAIT_INTERVAL=2000
